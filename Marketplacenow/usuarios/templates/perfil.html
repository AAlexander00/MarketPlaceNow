{% extends "base.html" %}
{% load static %}

{% block title %}Mi Perfil{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto mt-10 px-4 lg:px-8 grid grid-cols-1 lg:grid-cols-4 gap-6">

  <!-- Sidebar Izquierdo -->
  <aside class="bg-white p-4 shadow rounded-md col-span-1 space-y-4 text-sm">
    <h3 class="text-lg font-bold text-gray-700">Centro Personal</h3>
    <div>
      <h4 class="font-semibold mb-1">Mi Cuenta</h4>
      <ul class="space-y-1">
        <li><a href="#" class="text-red-600 font-semibold">Mi Perfil</a></li>
        <li><a href="#" class="hover:text-red-600">Direcciones</a></li>
        <li><a href="#" class="hover:text-red-600">Opciones de Pago</a></li>
        <li><a href="#" class="hover:text-red-600">Medidas</a></li>
      </ul>
    </div>
    <div>
      <h4 class="font-semibold mb-1">Mis Pedidos</h4>
      <ul class="space-y-1">
        <li><a href="#" class="hover:text-red-600">Pedidos</a></li>
        <li><a href="#" class="hover:text-red-600">Devoluciones</a></li>
      </ul>
    </div>
    <div>
      <h4 class="font-semibold mb-1">Servicio al Cliente</h4>
      <ul class="space-y-1">
        <li><a href="#" class="hover:text-red-600">Mis Notificaciones</a></li>
        <li><a href="#" class="hover:text-red-600">Registros de Servicio</a></li>
      </ul>
    </div>
    <!-- BotÃ³n cerrar sesiÃ³n -->
    <form action="{% url 'logout' %}" method="post" class="pt-4">
      {% csrf_token %}
      <button type="submit" class="w-full bg-red-600 text-white py-2 px-4 rounded hover:bg-red-700 transition font-semibold text-sm">
        Cerrar SesiÃ³n
      </button>
    </form>
  </aside>

  <!-- Panel Central -->
  <section class="col-span-2 space-y-6">
    <div class="bg-white p-6 rounded shadow">
      <h2 class="text-xl font-bold text-gray-800">Hola, {{ nombre }} ðŸ‘‹</h2>
      <div class="grid grid-cols-2 sm:grid-cols-4 mt-4 text-center text-sm text-gray-600">
        <div><p class="font-bold text-lg text-gray-800">***</p><span>Cupones</span></div>
        <div><p class="font-bold text-lg text-gray-800">***</p><span>Puntos</span></div>
        <div><p class="font-bold text-lg text-gray-800">***</p><span>Cartera</span></div>
        <div><p class="font-bold text-lg text-gray-800">***</p><span>Tarjetas</span></div>
      </div>
      <div class="bg-yellow-100 text-yellow-800 text-sm p-2 mt-4 rounded">
        Â¡Tienes <strong>3 cupones</strong> a punto de expirar!
      </div>
    </div>

    <!-- Historial de Pedidos -->
    <div class="bg-white p-6 rounded shadow">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-lg font-semibold text-gray-700">Mis Pedidos</h3>
      </div>

      {% if ordenes %}
        {% for orden in ordenes %}
          <div class="border-t pt-4">
            <div class="flex justify-between items-center mb-2">
              <div>
                <p class="text-sm text-gray-500">{{ orden.fecha_creacion|date:"d/m/Y H:i:s" }}</p>
                <p class="font-semibold text-gray-800">
                  {{ orden.detalles.count }} artÃ­culo{{ orden.detalles.count|pluralize }}
                </p>
              </div>
              <div class="text-right">
                <p class="font-bold text-sm 
                  {% if orden.estado == 'cancelado' %}
                    text-red-600
                  {% elif orden.estado == 'entregado' %}
                    text-green-600
                  {% else %}
                    text-yellow-600
                  {% endif %}
                ">
                  ${{ orden.total }}
                </p>
                <p class="text-sm text-gray-600 capitalize">{{ orden.estado }}</p>
                <a href="{% url 'detalle_orden' orden.id %}" class="text-blue-600 text-xs hover:underline">
                  Detalles del pedido
                </a>
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p class="text-center text-gray-500 mt-4">AÃºn no tienes pedidos registrados.</p>
      {% endif %}
    </div>
  </section>

  <!-- Sidebar Derecho -->
  <aside class="col-span-1 space-y-4">
    <div class="bg-white p-4 rounded shadow">
      <h4 class="font-semibold text-gray-800 mb-2">Servicio al Cliente</h4>
      <ul class="text-sm space-y-1">
        <li><a href="#" class="hover:underline text-gray-700">Mis Notificaciones</a></li>
        <li><a href="#" class="hover:underline text-gray-700">Registros de Servicio</a></li>
      </ul>
    </div>
    <div class="bg-white p-4 rounded shadow">
      <h4 class="font-semibold text-gray-800 mb-2">Siguiente <span class="text-xs text-red-500">Promo</span></h4>
      <div class="grid grid-cols-2 gap-2">
        <img src="https://placehold.co/80x80" class="rounded" alt="">
        <img src="https://placehold.co/80x80" class="rounded" alt="">
      </div>
    </div>
  </aside>

</div>
{% endblock content %}